<!DOCTYPE html>
<html ng-app="ngMap">
<head>
<title>Mappa Caltabellotta</title>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.2.0/sandstone/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css">
<script src="https://maps.google.com/maps/api/js?libraries=placeses,visualization,drawing,geometry,places&key=AIzaSyDMQX5Qu93BAwKBvSqO-pzUGMcIpWghu_o"></script>
<script src="https://code.angularjs.org/1.3.15/angular.js"></script>
<script src="https://rawgit.com/allenhwkim/angularjs-google-maps/master/build/scripts/ng-map.js"></script>
<script>
  angular.module('ngMap').controller('MyCtrl', function($http) {
    var vm=this;
	vm.marker=[];
	$http.get("https://raw.githubusercontent.com/caltabellotta/PuntiDiInteresse/master/poi.json")
    .then(function(response) {
        vm.marker = response.data;
    });	
    vm.showData = function() {
      alert(this.data.foo);
    }
  });
</script>
</head>

<body>

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">OpenData Caltabellotta</a>
    </div>
    <ul class="nav navbar-nav">
      <li class="active"><a href="#">Home</a></li>

    </ul>
  </div>
</nav>

<div class="container">
  <div class="jumbotron">
    <h1>OpenData Caltabellotta</h1> 
    <p>Benvenuti</p> 
  </div>
</div>


<div ng-controller="MyCtrl as vm">
<div class="container">
  
 <ng-map zoom="13" center="[37.576347, 13.215090]">
      <marker ng-repeat="m in vm.marker"
        position="{{m.Latitude}},{{m.Longitude}}"
        data="{{data[$index]}}"
        on-click="showData()";
        title="{{m.Name}}"></marker>
    </ng-map>	
</div>
<div class="container">	
<table class="table table-bordered table-striped">
    
    <thead>
      <tr>
        <td>
          ID
        </td>
        <td>
          Categoria
        </td>
        <td>
          Nome 
        </td>
      </tr>
    </thead>
    
    <tbody>
      <tr ng-repeat="m in vm.marker | orderBy:'Name' ">
        <td>
			{{m.ID}}		
		</td>
		<td>
			{{m.Category}}
		</td>
        <td>
			{{m.Name}}
		</td>
      </tr>
    </tbody>
    
  </table>	
</div>
	
  </div>
</body>
</html>
